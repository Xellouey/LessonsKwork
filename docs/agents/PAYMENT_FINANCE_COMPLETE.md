# Payment & Finance Development - COMPLETE

## üéØ –°—Ç–∞—Ç—É—Å: –ó–ê–í–ï–†–®–ï–ù–û ‚úÖ

**Agent 2** —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Telegram Stars, —Å–∏—Å—Ç–µ–º–æ–π –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤, —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é –∏ –≤—ã–≤–æ–¥–æ–º —Å—Ä–µ–¥—Å—Ç–≤.

## üìã –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### ‚úÖ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- **PaymentService**: –°–æ–∑–¥–∞–Ω–∏–µ, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
- **Telegram Stars –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ Telegram
- **Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç Telegram
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º, –≤–∞–ª—é—Ç—ã –∏ payload
- **–¢–∞–π–º–∞—É—Ç—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–º–µ–Ω–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- **PromoCodeService**: –°–æ–∑–¥–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏
- **–¢–∏–ø—ã —Å–∫–∏–¥–æ–∫**: –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–∫–∏–¥–∫–∏
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**: –õ–∏–º–∏—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, —Å—Ä–æ–∫–∏ –¥–µ–π—Å—Ç–≤–∏—è
- **–ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ**: Bulk creation –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º

### ‚úÖ –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- **FinanceService**: –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- **–î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –î–æ—Ö–æ–¥—ã, –ø–æ–∫—É–ø–∫–∏, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
- **–ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –†–∞–∑–±–∏–≤–∫–∞ –ø–æ –¥–Ω—è–º, —Ä–æ—Å—Ç
- **–¢–æ–ø –ø—Ä–æ–¥–∞–∂**: –°–∞–º—ã–µ –ø—Ä–æ–¥–∞–≤–∞–µ–º—ã–µ —É—Ä–æ–∫–∏ –∏ –∫—É—Ä—Å—ã
- **–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤**: CSV –∏ JSON —Ñ–æ—Ä–º–∞—Ç—ã
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞**: Lifetime Value, —Ç–æ–ø –∫–ª–∏–µ–Ω—Ç—ã

### ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤
- **WithdrawService**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –≤—ã–≤–æ–¥
- **–°—Ç–∞—Ç—É—Å—ã**: Pending, Approved, Completed, Rejected
- **–õ–∏–º–∏—Ç—ã**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã
- **–ö–æ–º–∏—Å—Å–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- **–ò—Å—Ç–æ—Ä–∏—è**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—ã–≤–æ–¥–æ–≤

### ‚úÖ –ê—É–¥–∏—Ç –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **AuditLogger**: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –¥–ª—è –∞—É–¥–∏—Ç–∞

### ‚úÖ API Endpoints

#### –ü–ª–∞—Ç–µ–∂–∏ (`/api/v1/payments/`)
- `POST /create` - –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `POST /webhook` - Webhook –æ—Ç Telegram
- `POST /verify` - –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–∞
- `GET /{payment_id}` - –°—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞
- `GET /` - –°–ø–∏—Å–æ–∫ –ø–ª–∞—Ç–µ–∂–µ–π (–∞–¥–º–∏–Ω)
- `POST /cleanup-expired` - –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö

#### –ü—Ä–æ–º–æ–∫–æ–¥—ã (`/api/v1/promocodes/`)
- `POST /` - –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `GET /` - –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- `GET /{promo_id}` - –î–µ—Ç–∞–ª–∏ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `PUT /{promo_id}` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `DELETE /{promo_id}` - –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `POST /validate` - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `GET /{promo_id}/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞
- `POST /bulk-create` - –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ
- `GET /public/check/{code}` - –ü—É–±–ª–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

#### –§–∏–Ω–∞–Ω—Å—ã (`/api/v1/finance/`)
- `GET /daily/{date}` - –î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /monthly/{year}/{month}` - –ú–µ—Å—è—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /top-lessons` - –¢–æ–ø –ø—Ä–æ–¥–∞–∂
- `GET /withdrawable` - –î–æ—Å—Ç—É–ø–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
- `GET /analytics` - –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- `GET /export` - –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤
- `GET /overview` - –û–±–∑–æ—Ä —Ñ–∏–Ω–∞–Ω—Å–æ–≤
- `GET /trends` - –¢—Ä–µ–Ω–¥—ã –¥–æ—Ö–æ–¥–æ–≤

### ‚úÖ –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```sql
-- –ó–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
CREATE TABLE withdraw_requests (
    id INTEGER PRIMARY KEY,
    amount INTEGER NOT NULL,
    status VARCHAR(50) DEFAULT 'pending',
    telegram_wallet_address VARCHAR(255),
    requested_at DATETIME NOT NULL,
    processed_at DATETIME,
    notes TEXT,
    admin_id INTEGER REFERENCES admin_users(id),
    created_at DATETIME,
    updated_at DATETIME
);
```

### ‚úÖ –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è
```python
class WithdrawStatus(str, Enum):
    PENDING = "pending"
    APPROVED = "approved" 
    COMPLETED = "completed"
    REJECTED = "rejected"

class PaymentStatus(str, Enum):
    CREATED = "created"
    PENDING = "pending"
    PROCESSING = "processing"
    COMPLETED = "completed"
    FAILED = "failed"
    CANCELLED = "cancelled"
    REFUNDED = "refunded"
```

## üîå API –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

### –î–ª—è Agent 3 (User Interface - Telegram Bot)

#### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
payment_data = {
    "user_id": telegram_user.id,
    "item_id": lesson.id,
    "item_type": "lesson",  # –∏–ª–∏ "course"
    "promo_code": "DISCOUNT10"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
}

response = requests.post("/api/v1/payments/create", json=payment_data)
payment_info = response.json()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å payment_info –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Telegram –∏–Ω–≤–æ–π—Å–∞
invoice_payload = payment_info["invoice_payload"]
amount = payment_info["final_amount"]
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞
```python
# –ü—É–±–ª–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–æ–∫–æ–¥–∞
response = requests.get(f"/api/v1/promocodes/public/check/{promo_code}")
promo_info = response.json()

if promo_info["valid"]:
    discount = promo_info["discount_percent"]
    # –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
response = requests.get(f"/api/v1/users/{user_id}/purchases")
purchases = response.json()

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É
has_access = any(p["lesson_id"] == lesson_id for p in purchases)
```

### –î–ª—è Agent 4 (Administration)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏
```python
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞
promo_data = {
    "code": "NEWUSER20",
    "discount_percent": 20,
    "max_uses": 100,
    "expires_at": "2024-12-31T23:59:59"
}
response = requests.post("/api/v1/promocodes/", json=promo_data, headers=auth_headers)

# –ú–∞—Å—Å–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
response = requests.post(
    "/api/v1/promocodes/bulk-create",
    params={
        "count": 50,
        "discount_percent": 15,
        "prefix": "BULK15",
        "max_uses": 1
    },
    headers=auth_headers
)
```

#### –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
```python
# –î–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
response = requests.get("/api/v1/finance/daily/2024-01-01", headers=auth_headers)
daily_stats = response.json()

# –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–∞
response = requests.get(
    "/api/v1/finance/export",
    params={
        "start_date": "2024-01-01",
        "end_date": "2024-01-31",
        "format_type": "csv"
    },
    headers=auth_headers
)
```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∞–º–∏
```python
# –û–¥–æ–±—Ä–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥
response = requests.post(
    f"/api/v1/withdraws/{request_id}/approve",
    json={"notes": "Approved by admin"},
    headers=auth_headers
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–∂–∏–¥–∞—é—â–∏—Ö –∑–∞—è–≤–æ–∫
response = requests.get("/api/v1/withdraws/pending", headers=auth_headers)
```

### –î–ª—è Agent 5 (Communication)

#### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö
```python
# –®–∞–±–ª–æ–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
payment_messages = {
    "successful_payment": "‚úÖ –ü–ª–∞—Ç–µ–∂ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω! –£—Ä–æ–∫ '{lesson_title}' –¥–æ—Å—Ç—É–ø–µ–Ω.",
    "failed_payment": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –ø–ª–∞—Ç–µ–∂–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.",
    "promo_applied": "üéâ –ü—Ä–æ–º–æ–∫–æ–¥ '{promo_code}' –ø—Ä–∏–º–µ–Ω–µ–Ω! –°–∫–∏–¥–∫–∞: {discount}%",
    "withdraw_approved": "üí∞ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ {amount} Stars –æ–¥–æ–±—Ä–µ–Ω–∞!"
}
```

## üìä –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤–∏—Ç—å –≤ `.env` —Ñ–∞–π–ª:
```env
# –ü–ª–∞—Ç–µ–∂–∏ –∏ –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤
MIN_WITHDRAW_AMOUNT=100
MAX_WITHDRAW_AMOUNT=50000
COMMISSION_PERCENT=5
PAYMENT_TIMEOUT_MINUTES=30
TELEGRAM_STARS_CURRENCY=XTR

# Telegram Bot (–¥–ª—è Agent 3)
TELEGRAM_PAYMENT_PROVIDER_TOKEN=your-payment-provider-token
WEBHOOK_URL=https://your-domain.com/webhook
TELEGRAM_STARS_WEBHOOK_SECRET=your-webhook-secret

# –§–∏–Ω–∞–Ω—Å—ã
FINANCIAL_REPORT_EMAIL=admin@example.com
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Unit —Ç–µ—Å—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:
- `test_payment_service.py` - –¢–µ—Å—Ç—ã –ø–ª–∞—Ç–µ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
- `test_promo_service.py` - –¢–µ—Å—Ç—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤  
- `test_finance_service.py` - –¢–µ—Å—Ç—ã —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
- `test_api_endpoints.py` - API —Ç–µ—Å—Ç—ã

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤:
```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
pytest backend/tests/test_payment_service.py -v

# –¢–µ—Å—Ç—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
pytest backend/tests/test_promo_service.py -v

# –¢–µ—Å—Ç—ã API
pytest backend/tests/test_api_endpoints.py -v

# –í—Å–µ —Ç–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest backend/tests/ -v --cov=backend.services --cov=backend.api
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã:
- **–í–∞–ª–∏–¥–∞—Ü–∏—è webhook**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –æ—Ç Telegram
- **–ê—É–¥–∏—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- **Rate limiting**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ API –∑–∞–ø—Ä–æ—Å—ã
- **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É–º–º**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è:
- –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–µ–π (%)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –î–æ—Å—Ç—É–ø–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### Health check endpoints:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
GET /api/v1/payments/health

# –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
GET /api/v1/finance/overview
```

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤

### ‚úÖ Agent 3 (User Interface - Telegram Bot):
- API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –≥–æ—Ç–æ–≤
- –ü—É–±–ª–∏—á–Ω—ã–µ endpoints –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- Webhook endpoints –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ç–µ–Ω—Ç—É

### ‚úÖ Agent 4 (Administration):
- –ü–æ–ª–Ω—ã–π CRUD API –¥–ª—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
- –î–µ—Ç–∞–ª—å–Ω–∞—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á–µ—Ç–æ–≤ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –≤—ã–≤–æ–¥

### ‚úÖ Agent 5 (Communication):
- –°–æ–±—ã—Ç–∏—è –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≥–æ—Ç–æ–≤—ã
- –ê—É–¥–∏—Ç –ª–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
- API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **Agent 3**: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Telegram Bot —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π
2. **Agent 4**: –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏
3. **Agent 5**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö –∏ –≤—ã–≤–æ–¥–∞—Ö

## üìã –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ —Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–º:
```bash
curl -X POST "http://localhost:8000/api/v1/payments/create" \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": 1,
    "item_id": 1,
    "item_type": "lesson",
    "promo_code": "DISCOUNT10"
  }'
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞:
```bash
curl -X POST "http://localhost:8000/api/v1/promocodes/validate" \
  -H "Content-Type: application/json" \
  -d '{
    "code": "DISCOUNT10",
    "item_type": "lesson",
    "item_id": 1
  }'
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:
```bash
curl -X GET "http://localhost:8000/api/v1/finance/daily/2024-01-01" \
  -H "Authorization: Bearer YOUR_TOKEN"
```

**Payment & Finance —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏! üí∞‚ú®**